<!DOCTYPE html><html lang="en"> <head><meta name="viewport" content="width=device-width"><meta name="generator" content="Astro v4.15.8"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><title>使用 Doom Emacs 工作</title><meta charset="utf-8"><link rel="canonical" href="https://blog.mslxl.com/posts/tools/doomemacs/"><meta name="description" content="My story of discovering"><meta name="robots" content="index, follow"><meta property="og:title" content="使用 Doom Emacs 工作"><meta property="og:type" content="article"><meta property="og:image" content="https://blog.mslxl.com/placeholder.png"><meta property="og:url" content="https://blog.mslxl.com"><link rel="icon" href="/favicon.jpg" type="image/jpg"><meta name="twitter:image:src" content="https://blog.mslxl.com/placeholder.png"><meta name="twitter:image:alt" content="My story of discovering"><meta name="twitter:creator"><meta name="twitter:site"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="使用 Doom Emacs 工作"><meta name="twitter:description" content="My story of discovering"><link rel="stylesheet" href="/_astro/index.DJturBb8.css">
<link rel="stylesheet" href="/_astro/index.irxhXuQK.css">
<style>.code-container{position:relative}.clipboard-copy{position:absolute;top:.5rem;right:.5rem;width:1.75rem;height:1.75rem;display:flex;justify-content:center;align-items:center;border-radius:.25rem}.clipboard-copy:hover{background-color:#30363d}
</style><script type="module" src="/_astro/hoisted.zpUdL6BH.js"></script>
<script type="module" src="/_astro/page.CPvyyiTs.js"></script></head> <body>  <div un-max-lg="animate-fadein-down" un-lg="flex flex-row-reverse justify-between gap-4 px-8 mx-auto max-w-6xl" class="container contain-layout m-a"> <div un-lg="sticky top-0 h-screen py-20 animate-fadein-left gap-8" un-lg:flex="~ col justify-between items-start gap-4" class="p-7.5"> <header un-lg="grow-1 justify-between items-start" un-flex="~ col gap-2.5" class="text-center"> <hgroup un-hover:lg="bg-foreground color-background pt-3.75 pb-8.75 " un-lg=" write-vertical-right items-start px-2.5 pb-12 b-l-2px b-l-foreground-solid text-left" un-flex="~ col gap-2.5" class="cursor-pointer transition-[padding,background] duration-800 ease-in-out"> <a class="normal" href="/"> <h3 class="text-5 font-extrabold font-serif">Mslxl</h3> <h1 class="text-8 font-extrabold font-serif">Integrate Life</h1> </a> </hgroup> <nav class="text-center font-bold" un-flex="~ col gap-2"> <ul un-lg="flex-col items-start text-4" class="text-3.5" un-flex="~ row gap-2 justify-center"> <li> <a href="/posts/page/1">Posts</a> </li><li> <a href="/archive">Archive</a> </li><li> <a href="/categories">Categories</a> </li><li> <a href="/tomodachi">Friends</a> </li><li> <a href="/about">About</a> </li> </ul> <ul un-flex="~ row gap-1 justify-center"> <li> <a href="https://github.com/mslxl" target="_blank" title="github" class="icon i-mdi-github"></a> </li><li> <a href="/atom.xml" target="_blank" title="rss" class="icon i-mdi-rss"></a> </li> </ul> </nav> </header> <footer font-bold text-3 un-flex="~ col gap-1" un-lg="gap-3.5" class="max-lg:hidden"> <p>
© 2024 <a target="_blank" href="https://blog.mslxl.com" rel="noopener noreferrer">Mslxl</a> </p> <p>
Modified from <a target="_blank" href="https://github.com/Moeyua/astro-theme-typography" rel="noopener noreferrer">Typography</a> </p> <p>
Proudly published with <a target="_blank" href="https://astro.build" rel="noopener noreferrer">Astro</a> </p> </footer> </div> <main un-lg="py-20 min-w-3xl animate-fadein-down" class="p-7.5">  <article class="heti"> <header> <h1 class="post-title!"> <a href="/posts/tools/doomemacs/">使用 Doom Emacs 工作</a> </h1> <div class="mt-2 text-3.5"> <span>Posted at</span> <time>2021-08-30</time> <a class="ml-2.5" href="/categories/yi">
# 译 </a><a class="ml-2.5" href="/categories/Emacs">
# Emacs </a> </div> </header>  <div class="pt-8"> <h1 id="table-of-contents">Table of Contents</h1>
<ul>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#%E5%AE%89%E8%A3%85">安装</a></li>
<li><a href="#%E9%A1%B9%E7%9B%AE%E4%B8%8E%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4-projects-and-workspaces">项目与工作空间 (Projects and Workspaces)</a></li>
<li><a href="#%E5%B8%B8%E8%A7%81%E4%BB%BB%E5%8A%A1-common-tasks">常见任务 (Common Tasks)</a></li>
<li><a href="#%E5%AF%BB%E6%89%BE%E6%96%87%E6%9C%AC-finding-text">寻找文本 (Finding Text)</a></li>
<li><a href="#%E5%9C%A8%E6%96%87%E6%9C%AC%E9%97%B4%E7%A7%BB%E5%8A%A8-moving-to-text">在文本间移动 (Moving To Text)</a></li>
<li><a href="#%E6%89%A9%E5%A4%A7%E5%92%8C%E7%BC%A9%E5%B0%8F%E8%8C%83%E5%9B%B4-narrowing-and-widening-regions">扩大和缩小范围 (Narrowing and Widening Regions)</a></li>
<li><a href="#%E5%A4%9A%E5%85%89%E6%A0%87-multiple-cursors">多光标 (Multiple Cursors)</a></li>
<li><a href="#%E6%92%A4%E9%94%80%E4%B8%8E%E9%87%8D%E5%81%9A-undoing-and-redoing">撤销与重做 (Undoing and Redoing)</a></li>
<li><a href="#%E5%9C%A8%E7%BC%96%E8%AF%91%E8%BE%93%E5%87%BA%E9%97%B4%E5%AF%BC%E8%88%AA-navigating-compliation-output">在编译输出间导航 (Navigating Compliation Output)</a></li>
<li><a href="#%E6%9D%82%E9%A1%B9">杂项</a></li>
<li><a href="#%E4%BA%86%E8%A7%A3%E6%9B%B4%E5%A4%9A-doom">了解更多 Doom</a></li>
</ul>
<p>原文: <a href="https://noelwelsh.com/posts/doom-emacs/">Doom Emacs Workflows</a> 发布于 2019 年 2 月 15日，部分功能可能已发生变化。</p>
<p>我最近放弃了 Spacemacs, 开始使用 <a href="https://github.com/hlissner/doom-emacs">Doom Emacs</a>. 目前为止，Doom Emacs 的文档仍十分简陋，所以我用 Doom Emacs 写了这篇个人笔记来介绍我的工作流（包含一些我认为比较重要但是缺少文档的功能）。</p>
<p>如果你有下面的情况，Doom 也许就很适合你：</p>
<ul>
<li>喜欢 Emacs 又想使用 Vim 的按键绑定</li>
<li>没有时间配置像是 helm 之类的优秀插件</li>
<li>感觉 Spacemacs 太慢</li>
</ul>
<p>这篇文章并不打算介绍 Emacs 的运行方式和基础的 Vim 按键绑定，而是把焦点放在我认为出类拔萃的地方</p>
<p><a id="org6a62219"></a></p>
<h1 id="安装">安装</h1>
<p>一定要使用 <code>develop</code> 分支，不是 <code>master</code> ! 使用 <code>develop</code> 分支需要</p>
<div class="expressive-code"><link rel="stylesheet" href="/_astro/ec.0niu6.css"><script type="module" src="/_astro/ec.8zarh.js"></script><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">git clone https://github.com/hlissner/doom-emacs ~/.emacs.d</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">cd ~/.emacs.d</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">git checkout develop</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="git clone https://github.com/hlissner/doom-emacs ~/.emacs.dcd ~/.emacs.dgit checkout develop"><div></div></button></div></figure></div>
<p>然后运行 <code>bin/doom quickstart</code> 即可完成安装。之后您可以运行 <code>bin/doom help</code> 查看可用命令。</p>
<p><a id="org8fec0f7"></a></p>
<h1 id="项目与工作空间-projects-and-workspaces">项目与工作空间 (Projects and Workspaces)</h1>
<p>我发现使用项目与工作空间来管理工作十分有用。我从中得到了两点好处：从当前项目中寻找东西更快，还可以快速方便的通过保存和恢复 window 和 buffer 配置来回到工作。在 Doom 中，这些功能由 <code>projectile</code> 和 <code>persp-mode</code> 实现。</p>
<p>基本工作流程如下：</p>
<ul>
<li>判断我自己要做什么。是单独的一个项目，还是涉及多个项目 (例如管理 Todo 列表)，亦或是不需要在项目中保存 (像是进行在 scratch buffer 中快速计算)？如果是单独的项目，就把它放到一个属于它的工作空间中，否则就把它放在默认工作空间中（main)</li>
<li>使用 <code>SPC TAB .</code> 切换到恰当的工作空间。如果这个工作空间并没有显示，那么就用 <code>SPC TAB l</code> 加载这个工作空间，或者使用 <code>SPC TAB n</code> 创建一个新工作空间。就我个人而言，我经常用 <code>SPC TAB r</code> 来使工作空间的命名中包含更多信息，然后用 <code>SPC TAB s</code> 保存。</li>
<li>当我切换到一个已存在的工作空间时，Emacs 会恢复到我上次在项目的工作状态，这样我可以直接开始工作。不然我会使用 <code>SPC p p</code> 来选择一个项目来继续工作。</li>
</ul>
<p>有三个命令非常有用：</p>
<ul>
<li><code>SPC SPC</code> 在当前项目中切换文件，支持模糊搜索</li>
<li><code>SPC ,</code> 在项目中切换 buffer, 同样支持模糊搜索</li>
<li><code>SPC f r</code> 打开最近浏览的文件</li>
</ul>
<p><a id="org7198548"></a></p>
<h1 id="常见任务-common-tasks">常见任务 (Common Tasks)</h1>
<p>我经常使用的有：</p>
<ul>
<li><code>SPC :</code> 而非 <code>M x</code></li>
<li><code>SPC g g</code> 打开 <a href="https://magit.vc/">Magit</a>, 这是我唯一使用 Git 的方式</li>
</ul>
<p>我偶尔使用的有：</p>
<ul>
<li><code>SPC .</code> 打开一个文件。值得一提的是使用 <code>SPC SPC</code> 比使用这个要快，只有当你要打开当前项目之外的文件时才会使用这个命令</li>
<li><code>SPC b B</code> 切换到当前项目外的 buffer</li>
</ul>
<p><a id="org747bd18"></a></p>
<h1 id="寻找文本-finding-text">寻找文本 (Finding Text)</h1>
<p>如果你知道有某个文本存在，却不知道它的位置，有两种方式可以找到它：</p>
<ul>
<li><code>SPC s p</code> 搜索当前项目中的所有文件 （按下 <code>SPC s</code> 后等待弹窗出现可以了解其他选项)。您可以在搜索结果的 buffer 中使用 <code>Return</code> 跳转到该位置，或者使用 <code>C-c C-e</code> 来编辑所有的搜索结果。无论您修改了什么，您都可以使用 <code>C-c C-c</code> 来保存修改，或者使用 <code>C-c C-k</code> 放弃保存。这对于简单或者复杂的编辑多个文件中的内容都特别有用。</li>
<li><code>/</code> 在当前 buffer 中搜索。使用 <code>n</code> 和 <code>N</code> 分别跳转的下一个搜索结果和上一个搜索结果。 (使用 <code>?</code> 可以向上搜索)</li>
</ul>
<p><a id="orgdeef4b5"></a></p>
<h1 id="在文本间移动-moving-to-text">在文本间移动 (Moving To Text)</h1>
<p>当您在屏幕上看到某个特定文字时，有很多方式可让您快速的将光标移动到那里：</p>
<ul>
<li><code>s</code> 然后输入两个字符，您就能跳转的当前位置下方的最近的匹配项，用 <code>S</code> 则可以向上跳转。输入 <code>,</code> 可以继续跳转到该 buffer 中的上一项，=;= 则能跳转到下一项。通常配置下，这些功能只会跳转到当前行中的匹配结果，但是如果您多次输入 <code>,</code> 或 <code>;</code> ，您就可以在整个 buffer 中进行跳转操作。这是 <a href="https://github.com/hlissner/evil-snipe">evil-snipe</a> 的功能。</li>
<li><code>g s SPC</code> ，然后键入你想找的文字。当没有歧义时，您可以直接跳转到那里，否则需要使用特定的字母组合来选择位置。如果您在 <code>config.el</code> 文件中配置了 <code>(seq avy-all-windows t)</code> ，则会在所有的可见窗口中进行匹配。我比较喜欢这个功能，因为他能让我在屏幕中快速跳转。该功能使用了 <a href="https://github.com/abo-abo/avy">Avy</a>。</li>
<li><code>g s</code> 后等待弹窗出现可以了解其他选项，其实我并没有真正使用过这个，因为上面的两个方法完全可以满足我的需求，但是或许我在这里错过了什么。</li>
</ul>
<p>当我想跳转到的位置和现在的位置比较近时，我会使用 evil-snipe (<code>s</code> 和 <code>S</code>)。如果位置较远或在另一个窗口，我会使用 Avy (<code>g s SPC</code>)。它们都能用来选择文本，假如我们有这样的一串文本：</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">Just some example text</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="Just some example text"><div></div></button></div></figure></div>
<p>当光标位于 <code>J</code> 时，如果我们想选中 <code>Just some example</code> 。我们可以用 <code>v3e</code> ，但如果这样我们就需要去查单词的数量（还要记住 <code>e</code> 和 <code>w</code> 的区别），因此，我们可以用 <code>vsle</code> 。 <code>s</code> 表示使用 evil-snipe , <code>le</code> 则是我们找的两个字母。我们也可以用 <code>vgs SPC le</code> 来使用 Avy (然后我们需要把光标向右移动一个字母)。</p>
<p>使用 evil-snipe 有点复杂。它把选择命令绑定到了 <code>s</code> 键上，但是其他一些指令（例如 yank, 或者说 <code>y</code>) 被 <a href="https://github.com/emacs-evil/evil-surround">evil-surround</a> 绑定到了 <code>s</code> 上。在这种情况下， evil-snipe 被绑定到了 <code>z</code> 键（ <code>Z</code> 来向后搜索）。如果我们不想在选中的文字中包含某个特定文本，我们可以使用 <code>x</code> ( <code>X</code> 键向后搜索 )</p>
<p><a id="orgd28a4f0"></a></p>
<h1 id="扩大和缩小范围-narrowing-and-widening-regions">扩大和缩小范围 (Narrowing and Widening Regions)</h1>
<blockquote>
<p>译者注：该部分在新版 Doom emacs 中有较大变化，故该部分存在少许调整与原文不同，如需查看旧版本操作请查看原文。</p>
</blockquote>
<p>在 Emacs 中有一个叫 Narrowing 的功能，对于将 buffer 限制到一个选择的文本中十分有用，但它由于经常给初学者造成困扰，默认情况下被禁用，在初次使用时可以选择是否启用。它特别适合与多个光标（见下）同时使用。您可以用 <code>C-x n n</code> 来将范围缩小到当前选择的区域，使用 <code>C-x n w</code> 执行相反操作（即扩大范围）。用 <code>C-x n d</code> 来缩小范围到当前的函数也十分有用。</p>
<p><a id="org806bc14"></a></p>
<h1 id="多光标-multiple-cursors">多光标 (Multiple Cursors)</h1>
<p>多光标允许您同时编辑多个地方。Doom 提供了两种多光标的实现方式，它们分别是 <a href="https://github.com/hlissner/evil-multiedit">evil-multiedit</a> 和 <a href="https://github.com/gabesoft/evil-mc">evil-mc</a>。我各人感觉 evil-multiedit 更容易使用，但是功能比较局限。</p>
<p>有两种方式可以开始使用 evil-multiedit ：</p>
<ul>
<li>选择您想编辑的文本，然后按 <code>R</code> 继续选择在当前 buffer 中您想要编辑的文本。</li>
<li>将光标移动到您想要编辑的单词旁，然后使用 <code>M-d</code> 和 <code>M-D</code> 来分别选中上一个或下一个相同的单词（可以先缩小范围）</li>
</ul>
<p>当您选择了一些文本区域后，您可以使用 <code>C-n</code> (下一个) 和 <code>C-p</code> (上一个)。按下选中的文本上按回车键，该文本区域会被取消选中。使用这些按键，您可以随意地选中文本。</p>
<p>当您完成了选择后，对一个区域的修改将会影响所有的区域，大多数的 evil 命令都能够与 evil-multiedit 配合使用。</p>
<p>您也可以使用平时的取消按键（ <code>ESC</code> 或 <code>C-[</code> ）来退出 evil-multiedit 模式。</p>
<p>evil-mc 是另外一个多光标实现，它更加的灵活，但也更加难以使用。使用 evil-mc 创建多个光标有以下几种选择：</p>
<ul>
<li><code>gzm</code> 在所有的匹配项创建一个光标（可以先缩小范围）</li>
<li><code>gzd</code> 创建光标，然后移动到下一个匹配项（ <code>gzd</code> 移动到上一项）</li>
<li><code>gzj</code> 创建光标，然后移动到下一行 ( <code>gzk</code> 移动到上一行 )</li>
<li><code>gzz</code> 在当前项创建光标。</li>
</ul>
<p>这些创建光标会重复您在真正的光标上输入的命令。您可以用 <code>gzt</code> 来临时关闭多光标，从光标位置继续可以再次按相同的按键 <code>gzt</code></p>
<p>大多数的命令都能与 evil-mc 配合使用，但是少数我使用的功能不能用：</p>
<ul>
<li><code>DEL</code> (backspace) 在插入模式下不能在所有的光标进行重复操作</li>
<li><code>ysiw</code> 在所有模式下都不能在所有的光标下工作 (尽管 <code>ciw</code> 可以)</li>
</ul>
<p>如果光标之间不同步，使用撤消一些命令通常可以解决问题。</p>
<p>当您完成了编辑操作后，按下 <code>gzu</code> 来移除所有光标</p>
<p><a id="org35af536"></a></p>
<h1 id="撤销与重做-undoing-and-redoing">撤销与重做 (Undoing and Redoing)</h1>
<blockquote>
<p>译者注：原文在这里标注了 TODO</p>
</blockquote>
<p><em>TODO</em></p>
<p><code>u</code> 键撤销。 <code>undo-tree</code> 系统比较复杂，但是您会慢慢习惯它。 <code>C-r</code> 和 <code>M-_</code> 执行重做操作， <code>C-x u</code> 显示撤销树（undo tree）</p>
<p><a id="org4a475a3"></a></p>
<h1 id="在编译输出间导航-navigating-compliation-output">在编译输出间导航 (Navigating Compliation Output)</h1>
<p><em>TODO</em></p>
<p>按下 <code>SPC p c</code> 或 <code>M-b</code> 来进行编译。 <code>]e</code> 和 <code>[e</code> 查看下一个或上一个 flycheck (一种拼写检查) 错误。 <code>SPC c x</code> 来分别列出所有错误。</p>
<p><a id="org2d0afb3"></a></p>
<h1 id="杂项">杂项</h1>
<ul>
<li><code>gcc</code> 注释或取消当前行的注释</li>
<li><code>SPC oA</code> 打开 Org agenda</li>
<li><code>SPC x</code> 为任意笔记打开临时 buffer (scratch buffer)</li>
<li>更改文字大小： <code>M-=+</code> 增加字号， <code>M--</code> 缩小字号， <code>M-+</code> 重置</li>
</ul>
<p><a id="orgdbc49a3"></a></p>
<h1 id="了解更多-doom">了解更多 Doom</h1>
<p>我对 Doom 的了解大多数都是通过阅读<a href="https://github.com/hlissner/doom-emacs/blob/develop/modules/config/default/+evil-bindings.el">默认按键绑定</a>, 查看我不认识的命令获得的。在 scratch buffer 中实验每个命令的含义很容易。</p> </div>  </article> <footer class="mt-5">  <p class="flex items-center gap-2"> <span class="inline-flex items-center"> <i class="i-mdi-chevron-double-left icon"></i> <a href="/posts/others/2022-dispearpage">Previous post: 关于消失的页面</a> </span> <span class="inline-flex items-center"> <a href="/posts/others/v2ray">Next post: V2Ray Setup</a> <i class="i-mdi-chevron-double-right icon"></i> </span> </p> </footer> <!-- <footer class="mt-5">
  <p class="mb-2.5">{t('page_number', page.currentPage)} / {t('page_count', page.lastPage)}</p>
  <p class="flex items-center gap-2">
    <span class="inline-flex items-center">
      <i class="i-mdi-chevron-double-left icon"></i>
      {page.url.prev ? <a href={page.url.prev}> {t('prev')} </a> : <span>{t('prev')}</span>}
    </span>

    <span class="inline-flex items-center">
      {page.url.next ? <a href={page.url.next}>{t('next')}</a> : <span>{t('next')}</span>}
      <i class="i-mdi-chevron-double-right icon"></i>
    </span>
  </p>
</footer> -->  <div py-16> <giscus-widget id="comments" repo="mslxl/mslxl.github.io" repoId="MDEwOlJlcG9zaXRvcnkxMjcwMTEwMjI=" category="Show and tell" categoryId="DIC_kwDOB5IIzs4CfW4f" mapping="title" strict="0" reactionsEnabled="1" emitMetadata="1" inputPosition="top" theme="light" lang="zh-CN" loading="lazy"></giscus-widget>  </div>  <div class="p-10"> <div> <img class="m-auto" src="https://moe-counter.glitch.me/get/@mslxl" alt="moe-counter"> <p class="text-sm text-gray-500 text-center">统计自 2024 年 9 月</p> </div> </div> </main> <footer font-bold text-3 un-flex="~ col gap-1" un-lg="gap-3.5" class="lg:hidden p-7.5"> <p>
© 2024 <a target="_blank" href="https://blog.mslxl.com" rel="noopener noreferrer">Mslxl</a> </p> <p>
Modified from <a target="_blank" href="https://github.com/Moeyua/astro-theme-typography" rel="noopener noreferrer">Typography</a> </p> <p>
Proudly published with <a target="_blank" href="https://astro.build" rel="noopener noreferrer">Astro</a> </p> </footer> </div>  </body></html>  